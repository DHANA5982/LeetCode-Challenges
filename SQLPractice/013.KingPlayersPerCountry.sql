-- Active: 1761408174101@@localhost@5432@PostgreSQLDB
USE PostgreSQLDB;

CREATE TABLE King_Players_Demographic (
    player_id INTEGER PRIMARY KEY,
    registration_date DATE,
    country TEXT,
    age INTEGER,
    gender TEXT
);

INSERT INTO King_Players_Demographic VALUES
(1, '2024-01-19', 'Spain', 24, 'O'), (2, '2024-12-22', 'Japan', 20, 'F'), (3, '2025-07-26', 'United Kingdom', 20, 'M'), 
(4, '2025-06-21', 'Brazil', 20, 'M'), (5, '2025-05-22', 'Italy', 21, 'M'), (6, '2023-11-25', 'France', 24, 'O'), 
(7, '2024-04-22', 'Saudi Arabia', 20, 'M'), (8, '2024-01-06', 'Saudi Arabia', 23, 'M'), (9, '2024-10-25', 'Australia', 23, 'M'), 
(10, '2025-05-20', 'Japan', 22, 'F'), (11, '2024-09-20', 'Brazil', 21, 'O'), (12, '2024-10-07', 'France', 25, 'F'), 
(13, '2025-02-24', 'Spain', 22, 'O'), (14, '2024-07-27', 'United Kingdom', 20, 'O'), (15, '2025-06-10', 'United States', 23, 'M'), 
(16, '2024-03-18', 'Canada', 21, 'O'), (17, '2023-12-18', 'France', 18, 'F'), (18, '2024-10-19', 'Russia', 20, 'M'), 
(19, '2023-10-29', 'Italy', 23, 'O'), (20, '2025-08-30', 'Spain', 19, 'F'), (21, '2025-07-17', 'India', 25, 'F'), 
(22, '2024-08-04', 'Saudi Arabia', 23, 'F'), (23, '2024-09-07', 'Canada', 22, 'F'), (24, '2025-01-20', 'Australia', 21, 'O'), 
(25, '2025-05-21', 'Spain', 21, 'O'), (26, '2025-05-24', 'Italy', 19, 'M'), (27, '2023-10-08', 'Australia', 25, 'O'), 
(28, '2025-03-30', 'France', 25, 'M'), (29, '2024-09-16', 'United States', 25, 'F'), (30, '2024-04-30', 'Saudi Arabia', 21, 'F'),
(31, '2024-12-01', 'India', 22, 'M'), (32, '2024-11-11', 'India', 24, 'F'), (33, '2024-12-15', 'United States', 23, 'M'),
(34, '2024-09-21', 'United States', 21, 'F'), (35, '2024-07-18', 'Canada', 20, 'O'), (36, '2024-04-25', 'France', 25, 'M'),
(37, '2025-01-02', 'Japan', 19, 'F'), (38, '2025-01-15', 'Japan', 23, 'O'), (39, '2024-10-05', 'Australia', 21, 'M'),
(40, '2024-08-18', 'Italy', 22, 'M'), (41, '2025-02-01', 'Spain', 24, 'F'), (42, '2024-11-09', 'United Kingdom', 20, 'M'),
(43, '2025-01-10', 'Brazil', 21, 'O'), (44, '2024-07-12', 'Russia', 19, 'M'), (45, '2024-05-28', 'France', 20, 'F'),
(46, '2024-06-20', 'Canada', 21, 'O'), (47, '2025-01-05', 'Saudi Arabia', 23, 'M'), (48, '2024-09-26', 'Saudi Arabia', 24, 'F'),
(49, '2024-08-12', 'India', 25, 'O'), (50, '2024-10-02', 'Australia', 22, 'M');

CREATE TABLE King_Player_Activity (
    player_id INT,
    activity_date DATE,
    session_count INT,
    minutes_played INT
);

INSERT INTO King_Player_Activity VALUES 
(1, '2024-11-27', 4, 30), (2, '2025-05-15', 4, 47), (3, '2025-08-31', 5, 16), (4, '2025-08-13', 5, 42), (5, '2025-07-29', 5, 36), 
(6, '2024-10-30', 5, 20), (7, '2025-01-13', 5, 29), (8, '2024-11-20', 3, 68), (9, '2025-04-16', 3, 9), (10, '2025-07-28', 2, 60), 
(11, '2025-03-29', 9, 8), (12, '2025-04-07', 2, 94), (13, '2025-06-16', 7, 82), (14, '2025-03-02', 7, 32), (15, '2025-08-08', 7, 63), 
(16, '2024-12-26', 5, 24), (17, '2024-11-11', 5, 94), (18, '2025-04-13', 4, 37), (19, '2024-10-17', 9, 38), (20, '2025-09-17', 8, 32), 
(21, '2025-08-26', 8, 85), (22, '2025-03-06', 9, 86), (23, '2025-03-23', 8, 32), (24, '2025-05-29', 6, 46), (25, '2025-07-29', 7, 38), 
(26, '2025-07-30', 3, 97), (27, '2024-10-06', 4, 74), (28, '2025-07-03', 8, 88), (29, '2025-03-27', 6, 7), (30, '2025-01-17', 4, 97),
(31, '2025-01-08', 6, 42), (32, '2025-01-09', 5, 33), (33, '2025-01-10', 7, 61), (34, '2025-01-11', 3, 28), (35, '2025-01-12', 8, 77),
(36, '2025-01-13', 4, 55), (37, '2025-01-14', 6, 39), (38, '2025-01-15', 7, 64), (39, '2025-01-16', 3, 31), (40, '2025-01-17', 9, 80),
(41, '2025-01-18', 8, 73), (42, '2025-01-19', 5, 48), (43, '2025-01-20', 7, 67), (44, '2025-01-21', 6, 40), (45, '2025-01-22', 8, 59),
(46, '2025-01-23', 5, 50), (47, '2025-01-24', 9, 90), (48, '2025-01-25', 7, 63), (49, '2025-01-26', 6, 46), (50, '2025-01-27', 8, 70);

CREATE TABLE King_Level_Attempt (
    attempt_id INT, 
    player_id INT,
    level_id INT,
    attempt_date DATE,
    score INT,
    success VARCHAR(10),
    attempts INT
);

INSERT INTO King_Level_Attempt VALUES
(101,1,1,'2025-01-03',500,'FALSE',1),(102,1,1,'2025-01-03',700,'TRUE',2),(103,2,2,'2025-01-05',400,'FALSE',1),
(104,2,2,'2025-01-05',450,'FALSE',2),(105,3,3,'2025-01-06',300,'TRUE',1),(106,4,1,'2025-01-07',600,'TRUE',1),
(107,5,2,'2025-01-09',550,'FALSE',1),(108,5,2,'2025-01-09',650,'TRUE',2),(109,6,3,'2025-01-10',720,'FALSE',1),
(110,6,3,'2025-01-10',830,'TRUE',2),(111,7,4,'2025-01-11',900,'FALSE',1),(112,8,5,'2025-01-12',400,'TRUE',1),
(113,9,1,'2025-01-14',520,'FALSE',1),(114,10,2,'2025-01-15',710,'FALSE',1),(115,11,3,'2025-01-17',630,'TRUE',1),
(116, 12, 1, '2025-01-18', 640, 'FALSE', 1), (117, 12, 1, '2025-01-18', 710, 'TRUE', 2), (118, 13, 2, '2025-01-19', 480, 'FALSE', 1),
(119, 13, 2, '2025-01-19', 590, 'TRUE', 2), (120, 14, 3, '2025-01-20', 560, 'FALSE', 1), (121, 14, 3, '2025-01-20', 610, 'FALSE', 2),
(122, 14, 3, '2025-01-20', 670, 'TRUE', 3), (123, 15, 4, '2025-01-21', 430, 'FALSE', 1), (124, 15, 4, '2025-01-21', 510, 'TRUE', 2),
(125, 16, 5, '2025-01-22', 720, 'TRUE', 1), (126, 17, 2, '2025-01-23', 520, 'FALSE', 1), (127, 17, 2, '2025-01-23', 540, 'TRUE', 2),
(128, 18, 3, '2025-01-24', 590, 'FALSE', 1), (129, 18, 3, '2025-01-24', 620, 'TRUE', 2), (130, 19, 4, '2025-01-25', 700, 'TRUE', 1),
(131, 20, 5, '2025-01-26', 450, 'FALSE', 1), (132, 20, 5, '2025-01-26', 510, 'FALSE', 2), (133, 20, 5, '2025-01-26', 590, 'TRUE', 3),
(134, 21, 1, '2025-01-27', 610, 'TRUE', 1), (135, 22, 2, '2025-01-28', 470, 'FALSE', 1), (136, 22, 2, '2025-01-28', 530, 'TRUE', 2),
(137, 23, 3, '2025-01-29', 490, 'FALSE', 1), (138, 23, 3, '2025-01-29', 650, 'TRUE', 2), (139, 24, 4, '2025-01-30', 640, 'FALSE', 1),
(140, 24, 4, '2025-01-30', 710, 'TRUE', 2), (141, 25, 5, '2025-01-31', 550, 'TRUE', 1), (142, 26, 6, '2025-01-31', 470, 'FALSE', 1),
(143, 26, 6, '2025-01-31', 590, 'TRUE', 2), (144, 27, 7, '2025-01-02', 660, 'FALSE', 1), (145, 27, 7, '2025-01-02', 710, 'TRUE', 2),
(146, 28, 8, '2025-01-03', 520, 'FALSE', 1), (147, 28, 8, '2025-01-03', 620, 'TRUE', 2), (148, 29, 9, '2025-01-04', 680, 'FALSE', 1),
(149, 29, 9, '2025-01-04', 770, 'TRUE', 2), (150, 30, 10, '2025-01-05', 800, 'TRUE', 1), (151, 1, 1, '2024-12-02', 480, 'FALSE', 1),
(152, 1, 1, '2024-12-02', 610, 'TRUE', 2), (153, 2, 2, '2024-12-03', 450, 'TRUE', 1), (154, 3, 3, '2024-12-04', 520, 'FALSE', 1),
(155, 3, 3, '2024-12-04', 680, 'TRUE', 2), (156, 4, 4, '2024-12-05', 590, 'FALSE', 1), (157, 4, 4, '2024-12-05', 720, 'TRUE', 2),
(158, 5, 5, '2024-12-06', 640, 'TRUE', 1), (159, 6, 2, '2024-12-07', 560, 'FALSE', 1), (160, 6, 2, '2024-12-07', 590, 'FALSE', 2),
(161, 6, 2, '2024-12-07', 630, 'TRUE', 3), (162, 7, 3, '2024-12-08', 400, 'FALSE', 1), (163, 7, 3, '2024-12-08', 480, 'FALSE', 2),
(164, 7, 3, '2024-12-08', 510, 'TRUE', 3), (165, 8, 4, '2024-12-09', 570, 'FALSE', 1), (166, 8, 4, '2024-12-09', 640, 'TRUE', 2),
(167, 9, 5, '2024-12-10', 450, 'TRUE', 1), (168, 10, 1, '2024-12-11', 390, 'FALSE', 1), (169, 10, 1, '2024-12-11', 470, 'TRUE', 2),
(170, 11, 2, '2024-12-12', 550, 'FALSE', 1), (171, 11, 2, '2024-12-12', 640, 'TRUE', 2), (172, 12, 3, '2024-12-13', 420, 'FALSE', 1),
(173, 12, 3, '2024-12-13', 560, 'TRUE', 2), (174, 13, 4, '2024-12-14', 510, 'TRUE', 1), (175, 14, 5, '2024-12-15', 610, 'TRUE', 1),
(176, 15, 6, '2024-12-16', 450, 'FALSE', 1), (177, 15, 6, '2024-12-16', 520, 'FALSE', 2), (178, 15, 6, '2024-12-16', 590, 'TRUE', 3),
(179, 16, 7, '2024-12-17', 460, 'FALSE', 1), (180, 16, 7, '2024-12-17', 610, 'TRUE', 2), (181, 17, 8, '2024-12-18', 530, 'TRUE', 1),
(182, 18, 9, '2024-12-19', 490, 'FALSE', 1), (183, 18, 9, '2024-12-19', 540, 'TRUE', 2), (184, 19, 10, '2024-12-20', 620, 'TRUE', 1),
(185, 20, 1, '2024-12-21', 400, 'FALSE', 1), (186, 20, 1, '2024-12-21', 450, 'TRUE', 2), (187, 21, 2, '2024-12-22', 560, 'TRUE', 1),
(188, 22, 3, '2024-12-23', 510, 'FALSE', 1), (189, 22, 3, '2024-12-23', 620, 'TRUE', 2), (190, 23, 4, '2024-12-24', 470, 'FALSE', 1),
(191, 23, 4, '2024-12-24', 540, 'TRUE', 2), (192, 24, 5, '2024-12-25', 640, 'TRUE', 1), (193, 25, 6, '2024-12-26', 580, 'FALSE', 1),
(194, 25, 6, '2024-12-26', 650, 'TRUE', 2), (195, 26, 7, '2024-12-27', 710, 'TRUE', 1), (196, 27, 8, '2024-12-28', 560, 'FALSE', 1),
(197, 27, 8, '2024-12-28', 640, 'TRUE', 2), (198, 28, 9, '2024-12-29', 460, 'FALSE', 1), (199, 28, 9, '2024-12-29', 590, 'TRUE', 2),
(200, 29, 10, '2024-12-30', 670, 'TRUE', 1), (201, 30, 11, '2024-12-31', 480, 'FALSE', 1), (202, 30, 11, '2024-12-31', 550, 'TRUE', 2),
(203, 31, 2, '2025-01-01', 560, 'TRUE', 1), (204, 32, 3, '2025-01-01', 470, 'FALSE', 1), (205, 32, 3, '2025-01-01', 580, 'TRUE', 2),
(206, 33, 4, '2025-01-01', 620, 'TRUE', 1);


CREATE TABLE King_Level_Info (
    level_id INT,
    difficulty VARCHAR(10),
    release_date DATE
);

INSERT INTO King_Level_Info VALUES
(1, 'Easy', '2024-12-01'), (2, 'Medium', '2024-12-15'), (3, 'Hard', '2025-01-01'),(4,	'Easy',	'2025-01-02'),
(5, 'Medium', '2025-01-03'), (6,	'Hard',	'2025-01-05'), (7, 'Easy', '2024-01-01'), (8, 'Medium', '2024-03-10'),
(9,	'Hard',	'2024-05-15'),(10, 'Easy', '2024-07-20'),  (11, 'Hard', '2024-10-01'), (12, 'Easy', '2025-01-06'),
(13, 'Medium', '2025-01-07'), (14, 'Hard', '2025-01-08'), (15, 'Easy', '2025-01-09'), (16, 'Medium', '2025-01-10'),
(17, 'Hard', '2025-01-11'), (18, 'Easy', '2025-01-12'), (19, 'Medium', '2025-01-13'), (20, 'Hard', '2025-01-14');


--- Find the total number of players per country.

SELECT COALESCE(country, 'Unknown') AS country, COUNT(*) AS total_players
FROM King_Players_Demographic
GROUP BY COALESCE(country, 'Unknown');